; SPIR-V
; Version: 1.0
; Generator: Khronos Glslang Reference Front End; 11
; Bound: 103
; Schema: 0
               OpCapability Shader
               OpCapability ShaderNonUniform
               OpCapability RuntimeDescriptorArray
               OpCapability SampledImageArrayNonUniformIndexing
               OpExtension "SPV_EXT_descriptor_indexing"
               OpExtension "SPV_KHR_non_semantic_info"
          %1 = OpExtInstImport "NonSemantic.Shader.DebugInfo.100"
          %3 = OpExtInstImport "GLSL.std.450"
               OpMemoryModel Logical GLSL450
               OpEntryPoint Fragment %main "main" %in_normal %outColor %in_color_idx %in_tex %in_tangent
               OpExecutionMode %main OriginUpperLeft
          %2 = OpString "C:\\Users\\Adams Humbert\\Documents\\Clion\\MadnessEngine\\renderer\\shaders\\shader_mesh_indirect.frag"
          %8 = OpString "uint"
         %16 = OpString "main"
         %19 = OpString "// OpModuleProcessed client vulkan100
// OpModuleProcessed target-env vulkan1.0
// OpModuleProcessed entry-point main
#line 1
#version 450

#extension GL_GOOGLE_include_directive : require
#extension GL_EXT_nonuniform_qualifier : require
#extension GL_EXT_scalar_block_layout: require
#extension GL_EXT_buffer_reference : require


layout (set = 1, binding = 0) uniform sampler2D texture_samples[];



layout(location = 0) in vec3 in_normal;
layout(location = 1) in vec4 in_tangent;
layout(location = 2) in vec2 in_tex;
layout(location = 3) in flat uint in_color_idx;


//look into subpasses/renderpasses for more/different out values
layout(location = 0) out vec4 outColor;

void main() {
    //outColor = vec4(inColor, 1.0) * texture(texSampler, in_tex); // if we want colors overlayed
    //outColor = texture(texSampler, in_tex);
    //    outColor = vec4(1.0f, 0.5f, 0.5f,1.0f); // old
    //    outColor = vec4(1.0f, 0.5f, 0.5f, 1.0f) * texture(texture_samples[(nonuniformEXT(pc.albedo_idx))], in_tex);

    vec3 norm = normalize(in_normal);
//    vec3 light_direction = normalize(lightPos - FragPos);



    outColor = texture(texture_samples[(nonuniformEXT(in_color_idx))], in_tex);
//    outColor = texture(texture_samples[(nonuniformEXT(0))], in_tex);
//        outColor = vec4(1.0f, 0.5f, 0.5f,1.0f); // old

}"
         %29 = OpString "float"
         %38 = OpString "norm"
         %47 = OpString "in_normal"
         %57 = OpString "outColor"
         %61 = OpString "type.2d.image"
         %62 = OpString "@type.2d.image"
         %66 = OpString "type.sampled.image"
         %67 = OpString "@type.sampled.image"
         %74 = OpString "texture_samples"
         %79 = OpString "in_color_idx"
         %93 = OpString "in_tex"
        %102 = OpString "in_tangent"
               OpSourceExtension "GL_EXT_buffer_reference"
               OpSourceExtension "GL_EXT_nonuniform_qualifier"
               OpSourceExtension "GL_EXT_scalar_block_layout"
               OpSourceExtension "GL_GOOGLE_cpp_style_line_directive"
               OpSourceExtension "GL_GOOGLE_include_directive"
               OpName %main "main"
               OpName %norm "norm"
               OpName %in_normal "in_normal"
               OpName %outColor "outColor"
               OpName %texture_samples "texture_samples"
               OpName %in_color_idx "in_color_idx"
               OpName %in_tex "in_tex"
               OpName %in_tangent "in_tangent"
               OpDecorate %in_normal Location 0
               OpDecorate %outColor Location 0
               OpDecorate %texture_samples Binding 0
               OpDecorate %texture_samples DescriptorSet 1
               OpDecorate %in_color_idx Flat
               OpDecorate %in_color_idx Location 3
               OpDecorate %82 NonUniform
               OpDecorate %85 NonUniform
               OpDecorate %86 NonUniform
               OpDecorate %in_tex Location 2
               OpDecorate %in_tangent Location 1
       %void = OpTypeVoid
          %5 = OpTypeFunction %void
       %uint = OpTypeInt 32 0
    %uint_32 = OpConstant %uint 32
     %uint_6 = OpConstant %uint 6
     %uint_0 = OpConstant %uint 0
          %9 = OpExtInst %void %1 DebugTypeBasic %8 %uint_32 %uint_6 %uint_0
     %uint_3 = OpConstant %uint 3
          %6 = OpExtInst %void %1 DebugTypeFunction %uint_3 %void
         %18 = OpExtInst %void %1 DebugSource %2 %19
    %uint_22 = OpConstant %uint 22
     %uint_1 = OpConstant %uint 1
     %uint_4 = OpConstant %uint 4
     %uint_2 = OpConstant %uint 2
         %21 = OpExtInst %void %1 DebugCompilationUnit %uint_1 %uint_4 %18 %uint_2
         %17 = OpExtInst %void %1 DebugFunction %16 %6 %18 %uint_22 %uint_0 %21 %16 %uint_3 %uint_22
      %float = OpTypeFloat 32
         %30 = OpExtInst %void %1 DebugTypeBasic %29 %uint_32 %uint_3 %uint_0
    %v3float = OpTypeVector %float 3
         %32 = OpExtInst %void %1 DebugTypeVector %30 %uint_3
%_ptr_Function_v3float = OpTypePointer Function %v3float
     %uint_7 = OpConstant %uint 7
         %35 = OpExtInst %void %1 DebugTypePointer %32 %uint_7 %uint_0
    %uint_28 = OpConstant %uint 28
         %37 = OpExtInst %void %1 DebugLocalVariable %38 %32 %18 %uint_28 %uint_0 %17 %uint_4
         %41 = OpExtInst %void %1 DebugExpression
%_ptr_Input_v3float = OpTypePointer Input %v3float
         %44 = OpExtInst %void %1 DebugTypePointer %32 %uint_1 %uint_0
  %in_normal = OpVariable %_ptr_Input_v3float Input
     %uint_8 = OpConstant %uint 8
         %46 = OpExtInst %void %1 DebugGlobalVariable %47 %32 %18 %uint_28 %uint_0 %21 %47 %in_normal %uint_8
    %v4float = OpTypeVector %float 4
         %52 = OpExtInst %void %1 DebugTypeVector %30 %uint_4
%_ptr_Output_v4float = OpTypePointer Output %v4float
         %54 = OpExtInst %void %1 DebugTypePointer %52 %uint_3 %uint_0
   %outColor = OpVariable %_ptr_Output_v4float Output
    %uint_33 = OpConstant %uint 33
         %56 = OpExtInst %void %1 DebugGlobalVariable %57 %52 %18 %uint_33 %uint_0 %21 %57 %outColor %uint_8
         %59 = OpTypeImage %float 2D 0 0 0 1 Unknown
         %63 = OpExtInst %void %1 DebugInfoNone
         %60 = OpExtInst %void %1 DebugTypeComposite %61 %uint_0 %18 %uint_33 %uint_0 %21 %62 %63 %uint_3
         %64 = OpTypeSampledImage %59
         %65 = OpExtInst %void %1 DebugTypeComposite %66 %uint_0 %18 %uint_33 %uint_0 %21 %67 %63 %uint_3
%_runtimearr_64 = OpTypeRuntimeArray %64
         %69 = OpExtInst %void %1 DebugTypeArray %65 %uint_0
%_ptr_UniformConstant__runtimearr_64 = OpTypePointer UniformConstant %_runtimearr_64
         %71 = OpExtInst %void %1 DebugTypePointer %69 %uint_0 %uint_0
%texture_samples = OpVariable %_ptr_UniformConstant__runtimearr_64 UniformConstant
         %73 = OpExtInst %void %1 DebugGlobalVariable %74 %69 %18 %uint_33 %uint_0 %21 %74 %texture_samples %uint_8
%_ptr_Input_uint = OpTypePointer Input %uint
         %76 = OpExtInst %void %1 DebugTypePointer %9 %uint_1 %uint_0
%in_color_idx = OpVariable %_ptr_Input_uint Input
         %78 = OpExtInst %void %1 DebugGlobalVariable %79 %9 %18 %uint_33 %uint_0 %21 %79 %in_color_idx %uint_8
%_ptr_UniformConstant_64 = OpTypePointer UniformConstant %64
         %84 = OpExtInst %void %1 DebugTypePointer %65 %uint_0 %uint_0
    %v2float = OpTypeVector %float 2
         %88 = OpExtInst %void %1 DebugTypeVector %30 %uint_2
%_ptr_Input_v2float = OpTypePointer Input %v2float
         %90 = OpExtInst %void %1 DebugTypePointer %88 %uint_1 %uint_0
     %in_tex = OpVariable %_ptr_Input_v2float Input
         %92 = OpExtInst %void %1 DebugGlobalVariable %93 %88 %18 %uint_33 %uint_0 %21 %93 %in_tex %uint_8
    %uint_37 = OpConstant %uint 37
%_ptr_Input_v4float = OpTypePointer Input %v4float
         %99 = OpExtInst %void %1 DebugTypePointer %52 %uint_1 %uint_0
 %in_tangent = OpVariable %_ptr_Input_v4float Input
        %101 = OpExtInst %void %1 DebugGlobalVariable %102 %52 %18 %uint_37 %uint_0 %21 %102 %in_tangent %uint_8
       %main = OpFunction %void None %5
         %15 = OpLabel
       %norm = OpVariable %_ptr_Function_v3float Function
         %26 = OpExtInst %void %1 DebugScope %17
         %27 = OpExtInst %void %1 DebugLine %18 %uint_22 %uint_22 %uint_0 %uint_0
         %25 = OpExtInst %void %1 DebugFunctionDefinition %17 %main
         %42 = OpExtInst %void %1 DebugLine %18 %uint_28 %uint_28 %uint_0 %uint_0
         %40 = OpExtInst %void %1 DebugDeclare %37 %norm %41
         %49 = OpLoad %v3float %in_normal
         %50 = OpExtInst %v3float %3 Normalize %49
               OpStore %norm %50
         %81 = OpExtInst %void %1 DebugLine %18 %uint_33 %uint_33 %uint_0 %uint_0
         %80 = OpLoad %uint %in_color_idx
         %82 = OpCopyObject %uint %80
         %85 = OpAccessChain %_ptr_UniformConstant_64 %texture_samples %82
         %86 = OpLoad %64 %85
         %94 = OpLoad %v2float %in_tex
         %95 = OpImageSampleImplicitLod %v4float %86 %94
               OpStore %outColor %95
         %96 = OpExtInst %void %1 DebugLine %18 %uint_37 %uint_37 %uint_0 %uint_0
               OpReturn
               OpFunctionEnd
